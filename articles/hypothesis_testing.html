<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>仮説検定 - Cookipedia</title>
<script src="../mathjax-config.js" defer></script>
<script type="text/javascript" id="MathJax-script" defer
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>
<link rel="stylesheet" type="text/css" href="../style.css">
<script src="../funcs.js"></script>
</head>
<body onload="init()">
<div class="container">
<div id="sidebar"></div>
<main class="main">
<div id="smartphone-header"></div>
<div class="item">
<h1>仮説検定</h1>
<p><b>仮説検定</b>（hypothesis testing）とは、<u>標本にもとづいて母集団の特徴の値に関する命題を検証する活動</u>である、と思われる。命題を「検証する」とは曖昧な表現であるが、母集団全体が手元にあるのではないので「証明する」ことはできない。何かしらの方針で母集団の性質を推測し、「どうもこの命題は真（偽）のようだ、と判断する」ことしかできない。のでいつもこのような表現になっているはずである。なお、用語として検証する命題のことを「帰無仮説」といい、それを偽のようだと判断することを「帰無仮説を棄却する」というのは世間でよく目にする通りである。</p>

<h2>形式的な定義</h2>
<p>より形式的には、<b>仮説検定</b>とは<u>手元の標本 $x$ が、標本空間の部分集合 $R \in \mathcal{X}$ に属するか属さないかを明らかにすること</u>である。ただし、$R$ は以下のように定める。
<div style="background: #f0f0f0; margin: 0.5em 0; padding: 1.0em;">
<p>母集団が何らかの確率分布族 $\mathcal{F}$ に属する確率分布であると仮定する<a class="note" href="#note1">[注釈1]</a>。<br/>
母集団 $f \in \mathcal{F}$ の何らかの特徴（通常は「パラメータ」という） $\theta: \mathcal{F} \to \Theta$ を考える<a class="note" href="#note2">[注釈2]</a>。<br/>
$\theta(f)$ が $\Theta$ のある部分集合に属するという命題 $H_0: \theta(f) \in \Theta_0$ を何かしら定める。<br/>
$H_0$ が真である下で得られる標本 $X$ が $R$ に属する確率が $\alpha$ 以下になるように $R$ を定める。</p>
<span style="font-size: 0.75em">慣習的に $\alpha=0.05$ が採用されることが多い。つまり、$R$ とは、「$H_0$ が真であるならば 5% 以下の確率でしか起きないような事象」≒「$H_0$ が真であるならばふつうは起きなさそうな事象」である。</span>
</div>つまり、$R$ は $\mathcal{F}, \, \theta, \, \Theta_0,\,\alpha$ をどう定めるかに依存する。なお、$H_0$ のことを「帰無仮説」といい、$\alpha$ のことを「有意水準」といい、$R$ のことを「棄却域」といい、「手元の $x$ は $x \in R$ である」ということを「帰無仮説を棄却する」というのは世間でよく目にする通りである<a class="note" href="#note3">[注釈3]</a>。</p>
<h3>棄却域をどこにとるべきか――対立仮説</h3>
<p>が、上記の定義は実際に $R$ を標本空間のどこにとるべきかについて何の手がかりも与えていない。というか、上の定義だと極端な話 $R$ は空集合でもよい。そうすると、帰無仮説が棄却されることが永久にない虚無な検定方式が完成する。</p>


<h2>具体例</h2>
<h3>具体例 1.</h3>
<p>標本 $X$ を「サイコロを振って 1 の目が出るかみる」という試行を 10 回繰り返した結果とする。この場合、各回の結果は「出た」か「出なかった」しかないので「10 回の試行のうち 1 の目が出た回数」に集約しても情報は失われない。集約したものを ${\rm sum}(X)$ とかくことにする。このとき以下の手順で棄却域 $R$ を定める。
<ul>
<li>「サイコロを振って1の目が出るかみるという試行結果」はベルヌーイ分布 ${\rm Ber}(p)$ から得られると考えて、母集団を ${\rm Ber}(p)$ とする。</li>
<li>ここで、$p$ が $1/6$ 以下であるという命題 $H_0: p \leqq 1/6$ を定めることにする。</li>
<li>$H_0$ が真のときにふつうは起きなさそうな $X$ を考えていく。今回の場合 ${\rm sum}(X)$ が二項分布 ${\rm Binom}(10, p)$ にしたがうことはわかりきっている。${\rm Binom}(10, 1/6)$ の累積分布関数は ${\rm cdf}(3) \fallingdotseq 0.93, \; {\rm cdf}(4) \fallingdotseq 0.98$ なので、$H_0$ が真のときの $p$ の最大値である $p=1/6$ のときであっても ${\rm sum}(X) > 4$ となる確率は $0.05$ を下回る。よって $R = \{ X \, | \, {\rm sum}(X) > 4 \}$ とできる。ので今回はそのままこの $R$ とする。</li>
</ul>
これで棄却域 $R$ は定まった。後は手元に得られている標本 $x$ が $R$ に属するか否か明らかにするだけである。もし $R$ に属するならば $H_0: p \leqq 1/6$ を棄却する。この状況を分析者の目的意識に即して表現すると、「1 の目が出た回数が 4 回を超えているので、1 の目が出る確率が $1/6$ 以下であるとは考えづらい」ということになる。</p>
<br/>



<h2>注釈</h2>
<ol class="note">
    <li id="note1">母集団には常にそのヒストグラムがつくる確率分布が自然に対応するが、ここでの「確率分布であると仮定する」は単に母集団を自然に対応する確率分布と同一視するにとどまるとは限らず、「日本人の身長の分布を連続的な正規分布と仮定する」といったような都合のよい押し付けをも含みうる。</li>
    <li id="note2">分布のパラメータ（しばしば「母数」とも）というと、筆者はポアソン分布に対する期待値のような、確率（密度）関数に出てくる定数といった印象を受けるが、分布のパラメータといったときは一般に分布を特徴付ける量であるはずなので、「特徴」といった方がわかりやすいと思い、あえて「特徴」とかいた。しかし、例えばポアソン分布の期待値ではなく歪度をパラメータとしたいなら文字を置き換えるだけであり、何も本質的な話ではない、はずである。</li>
    <li id="note3">通常、「『$H_0$ が正しくないと判断すること』を『帰無仮説を棄却する』という」と説明されると思う。「判断すること」というとヒューリスティックな意思決定であるような印象を受けるが、帰無仮説を棄却するまでは数学的手続きであるはずである。無論、$\mathcal{F}, \, \theta, \, \Theta_0,\,\alpha$ 及び検定方式はヒューリスティックに決めるわけだが、それらを決めた後にヒューリスティクスはないという意味である。どうでもよい。</li>
</ol>
<br/>

</div>
</main>
</div>
</body>
</html>
